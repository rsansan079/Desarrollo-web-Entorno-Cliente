<!doctype html>
<html lang="en">

<head>
  <style>
.jumbotron{

  max-height:180px;
}
  </style>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- css bootstrap 533 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <!-- bootstrap icons 1.11.3 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>

<body>
  <div class="container mt-4">
    <h1><img src="https://cdn.pixabay.com/photo/2016/01/16/08/04/aperture-1142967_1280.png" height="30px" width="30px">
      De Todo ...</h1>
    <h5>Carrito de la compra ...</h5>

    <div class="row">
      <div class="col-md-8">
        <div id="contProductos" class="row"></div>
      </div>
      <div class="col-md-4">
        <h3><img src="https://cdn.pixabay.com/photo/2013/07/12/17/22/basket-152089_1280.png " height="15%"
            width="15%">Cesta</h3>
        <table class="table">
          <thead>
            <tr>
              <th>Cod.</th>
              <th>Nombre</th>
              <th>Cant.</th>
              <th>Precio</th>
              <th>Subtotal</th>
              <th>Eliminar</th>
            </tr>
          </thead>
          <tbody id="cesta"></tbody>
        </table>
        <p id="total">Total: 0.00 €</p>
        <p id="totalIVA">Total + IVA (21%): 0.00 €</p>
      </div>
    </div>
  </div>
  <script>

    class Producto {


      constructor(id, nombre, precio, imagen) {

        this.producto.id = id;
        this.producto.nombre = nombre;
        this.producto.precio = precio;
        this.producto.imagen = imagen;
        return producto;

      }

    }
    class ContProductos {

        #productosDisp=[];

        constructor(arrayProductos){

// Transformamos los productos en un array de obj

          this.#productosDisp=arrayProductos.map(
              ([codigo, nombre, precio , imagen]) =>
              new Producto(codigo,nombre , precio, imagen)

          );
        }


          renderizarProductos(){


            









          }
        }



    class Cesta {

      #productosCesta = [];

añadirProducto(producto, cantidad) {
    const existente = this.#productosCesta.find(p => p.id === producto.id);
    if (existente) {
        existente.cantidad += cantidad;
    } else {
        this.#productosCesta.push({ id: producto.id, cantidad });
    }
    this.actualizarCesta();
}

eliminarProducto(id) {
    this.#productosCesta = this.#productosCesta.filter(p => p.id !== id);
    this.actualizarCesta();
}

calcularTotales() {
    let total = 0;
    const contenedor = document.getElementById('cesta');
    contenedor.innerHTML = '';
    this.#productosCesta.forEach(({ id, cantidad }) => {
        const producto = app.contProductos.obtenerProductoPorid(id);
        if (producto) {
            const subtotal = producto.precio * cantidad;
            total += subtotal;

            const fila = document.createElement('tr');
            fila.innerHTML = `
                <td>${id}</td>
                <td>${producto.nombre}</td>
                <td>${cantidad}</td>
                <td>${subtotal.toFixed(2)} €</td>
                <td><button class="btn btn-danger btn-sm" onclick="app.cesta.eliminarProducto('${id}')">Eliminar</button></td>
            `;
            contenedor.appendChild(fila);
        }
    });
    const totalIVA = total * 1.21;
    document.getElementById('total').textContent = `Total: ${total.toFixed(2)} €`;
    document.getElementById('totalIVA').textContent = `Total + IVA (21%): ${totalIVA.toFixed(2)} €`;
}

actualizarCesta() {
    this.calcularTotales();
}
}


    class App {
      constructor() {

        let arrayProductos = [
          ['001', 'Bolso', 20, 'https://cdn.pixabay.com/photo/2013/07/12/17/39/handbag-152158_1280.png'],
          ['002', 'Zapatos', 45, 'https://cdn.pixabay.com/photo/2016/10/07/22/44/shoes-1721347_1280.jpg'],
          ['003', 'Camiseta', 15, 'https://cdn.pixabay.com/photo/2016/05/23/00/09/t-shirt-1414650_1280.jpg'],
          ['004', 'Sombrero', 12, 'https://cdn.pixabay.com/photo/2015/09/18/18/07/hats-942299_1280.jpg'],
          ['005', 'Bufanda', 8, 'https://cdn.pixabay.com/photo/2016/01/06/17/42/scarf-1129432_1280.jpg']
        ];

      this.contProductos = new ContProductos(arrayProductos);
                this.cesta = new Cesta();
                this.contProductos.renderizarProductos();
        
    }
    }


    const app = new App();

  </script>
</body>

</html>